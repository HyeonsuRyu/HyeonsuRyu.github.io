---
layout: post
title: Keras 시작하기
subtitle: Tensorflow Core 튜토리얼
categories: DeepLearning
tags: [MNIST, KERAS]
---
딥러닝을 공부하면서 Tensorflow 1, Tensorflow 2, Keras 3가지를 이것저것 섞어서 공부하다 보니 어떤 프레임워크도 제대로 알고 있지 않게 됐다. 이 기회에 Tensorflow Core에 있는 튜토리얼을 통해 Tensorflow 2, Keras를 공부해보려고 한다.

## Keras 시작하기
 Tensorflow Core 튜토리얼에서 다루는 코드는 구글 코랩 환경에서 바로 작동한다. Keras는 딥러닝 프레임워크인 TensorFlow 위에서 작동하는 프레임워크이다. Tensorflow 2.0 부터는 Tensorflow 2.0에 Keras가 포함되어 있어 import tensorflow만으로도 사용 가능하다.
### 손 글씨 숫자 인식하기 (MNIST)
 mnist 데이터셋에는 0부터 9까지 숫자를 쓴 손글씨 이미지가 있다.
 ![MNIST Data set](https://storage.googleapis.com/tfds-data/visualization/fig/mnist-3.0.1.png)
 이런 손 글씨를 인공지능 모델에 학습하면 새로운 손 글씨가 있을 때 숫자가 몇 인지 인식할 수 있다.
####  코드 작성하기
 코드는 다음과 같은 구조를 가진다.
 - tensorflow, keras import
 - 데이터 가공
 - 훈련 모델 구축
 - 모델  훈련 및 평가
#### tensorflow, keras import
 ```python
 import tensorflow as tf
 from tensorflow import keras
 tf.__version__
 ```
 colab에는 tensorflow가 설치되어 있기 때문에 pip를 통해 설치할 필요가 없다.
#### 데이터 가공
 ```python
 mnist = keras.datasets.mnist

(x_train, y_train), (x_test, y_test) = mnist.load_data()
x_train, x_test = x_train / 255.0, x_test / 255.0
```
사진은 픽셀 당 0~255의 데이터를 가질 수 있다. 하지만 이렇게 범위가 크면 학습이 잘 이루어 지지 않아 0~1까지로 정규화 시켜준다.
#### 훈련 모델 구축
```python
model = keras.models.Sequential([
	keras.layers.Flatten(input_shape=(28, 28)),
	keras.layers.Dense(128, activation='relu'),
	keras.layers.Dropout(0.2),
	keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
			  loss='sparse_categorical_crossentropy',
			  metrics=['accuracy'])
```
- 사진이 28*28 크기이므로 input_shape를 (28, 28)로 잡아준다.
-  relu 활성화 함수를 이용하여 한 층을 만든다.
- dropout을 통해 overfitting을 방지한다.
- softmax를 통해 10가지의 경우로 나눈다.
- adam 옵티마이저로 최적화 시킨다.
- 손실 함수는 멀티클래스 분류에 사용되는 sparse categorical crossentropy를 사용한다.
- 정확도를 이용하여 모델의 성능을 평가한다.
#### 모델 훈련 및 평가
``` python
model.fit(x_train, y_train, epochs=5)
model.evaluate(x_test, y_test, verbose=2)
```
train data를 통해 훈련시킨 후 test 데이터로 성능을 평가한다.
<!--stackedit_data:
eyJoaXN0b3J5IjpbNTUxOTgzOTgzLDE3ODg0MDQ1NzEsMTk0Nz
YxNjcyOSwxODY5MTkzMDQzLC0xMzI1OTkwMF19
-->